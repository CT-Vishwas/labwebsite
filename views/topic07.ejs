<h1 id="lab-configuration-management-in-python-projects">Lab:
Configuration Management in Python Projects</h1>
<h2 id="objective">Objective</h2>
<p>Learn how to manage configuration settings for different environments
using <code>python-decouple</code> and JSON/YAML files.</p>
<h2 id="real-world-scenario">Real-World Scenario</h2>
<p>Imagine you are building a web application that connects to different
databases depending on the environment (development, testing,
production). You want to keep sensitive information like database
credentials out of your source code and easily switch
configurations.</p>
<p><strong>Example:</strong></p>
<ul>
<li>In development, you use a local SQLite database.</li>
<li>In production, you use a remote PostgreSQL database.</li>
</ul>
<p>You can store these settings in <code>.env</code>,
<code>config.json</code>, or <code>config.yaml</code> files:</p>
<p><strong><code>.env</code> (for development):</strong></p>
<pre><code>DEBUG=True
DB_ENGINE=sqlite
DB_NAME=dev.db</code></pre>
<p><strong><code>.env</code> (for production):</strong></p>
<pre><code>DEBUG=False
DB_ENGINE=postgresql
DB_NAME=prod_db
DB_USER=admin
DB_PASSWORD=securepassword
DB_HOST=db.example.com</code></pre>
<p>Your application loads the correct configuration based on the
environment, keeping credentials secure and making it easy to deploy to
different stages.</p>
<h2 id="step-1-organize-project-structure">Step 1: Organize Project
Structure</h2>
<p>Your project should look like:</p>
<pre><code>python_project/
├── src/
│   └── my_app/
│       ├── __init__.py
│       └── main.py
├── config/
│   ├── settings.py
│   ├── .env
│   ├── config.json
│   └── config.yaml
├── tests/
│   ├── __init__.py
│   └── test_main.py
├── setup.py
├── README.md</code></pre>
<h2 id="step-2-install-required-packages">Step 2: Install Required
Packages</h2>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install python-decouple pyyaml</span></code></pre></div>
<h2 id="step-3-add-configuration-files">Step 3: Add Configuration
Files</h2>
<ul>
<li><strong><code>.env</code></strong> (for python-decouple):</li>
</ul>
<pre><code>DEBUG=True
API_KEY=your_api_key_here</code></pre>
<ul>
<li><strong><code>config.json</code></strong>:</li>
</ul>
<div class="sourceCode" id="cb6"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;debug&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;api_key&quot;</span><span class="fu">:</span> <span class="st">&quot;your_api_key_here&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<ul>
<li><strong><code>config.yaml</code></strong>:</li>
</ul>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">debug</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">api_key</span><span class="kw">:</span><span class="at"> your_api_key_here</span></span></code></pre></div>
<h2 id="step-4-load-settings-in-your-application">Step 4: Load Settings
in Your Application</h2>
<p><strong>Using python-decouple
(<code>src/my_app/main.py</code>):</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> decouple <span class="im">import</span> config</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    debug <span class="op">=</span> config(<span class="st">&#39;DEBUG&#39;</span>, default<span class="op">=</span><span class="va">False</span>, cast<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    api_key <span class="op">=</span> config(<span class="st">&#39;API_KEY&#39;</span>, default<span class="op">=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Debug:&quot;</span>, debug)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API Key:&quot;</span>, api_key)</span></code></pre></div>
<p><strong>Using JSON (<code>src/my_app/main.py</code>):</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_json_config(path):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path) <span class="im">as</span> f:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> json.load(f)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    cfg <span class="op">=</span> load_json_config(<span class="st">&#39;config/config.json&#39;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Debug:&quot;</span>, cfg[<span class="st">&#39;debug&#39;</span>])</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API Key:&quot;</span>, cfg[<span class="st">&#39;api_key&#39;</span>])</span></code></pre></div>
<p><strong>Using YAML (<code>src/my_app/main.py</code>):</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yaml</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_yaml_config(path):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path) <span class="im">as</span> f:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> yaml.safe_load(f)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    cfg <span class="op">=</span> load_yaml_config(<span class="st">&#39;config/config.yaml&#39;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Debug:&quot;</span>, cfg[<span class="st">&#39;debug&#39;</span>])</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API Key:&quot;</span>, cfg[<span class="st">&#39;api_key&#39;</span>])</span></code></pre></div>
<h2 id="step-5-switch-environments">Step 5: Switch Environments</h2>
<ul>
<li>Create separate <code>.env</code>, JSON, or YAML files for each
environment (e.g., <code>config/dev.env</code>,
<code>config/prod.env</code>).</li>
<li>Load the appropriate file based on environment variable or
command-line argument.</li>
</ul>
<h2 id="step-6-test-your-configuration">Step 6: Test Your
Configuration</h2>
<ul>
<li>Run your application and verify settings are loaded correctly for
each environment.</li>
</ul>
<h2 id="example-using-dotenv">Example using <code>dotenv</code></h2>
<h2 id="step-1-install-dotenv">Step 1: Install dotenv</h2>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install dotenv</span></code></pre></div>
<h2 id="step-2-create-the-env-file-as-above">Step 2: Create the
<code>.env</code> file as above</h2>
<h2 id="step-3-load-the-configuration">Step 3: Load the
configuration</h2>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># settings.py</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to load the .env file (executed only once on module load)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>load_dotenv(dotenv_path<span class="op">=</span>os.path.join(os.path.dirname(os.path.abspath(<span class="va">__file__</span>)), <span class="st">&#39;..&#39;</span>, <span class="st">&#39;..&#39;</span>, <span class="st">&#39;.env&#39;</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>api_key <span class="op">=</span> os.getenv(<span class="st">&#39;API_KEY&#39;</span>,<span class="st">&#39;&lt;default_key&gt;&#39;</span>) </span></code></pre></div>
